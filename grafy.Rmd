---
title: "Grafy pro seminář KSS/PV1, který se bude konat 4. května 2022"
author: 'Připravil: František Kalvas'
date: 'Aktualizováno: `r Sys.Date()`'
output:
  html_document:
    toc: yes
    toc_depth: 3
    toc_float: yes
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# encoding: UTF-8
# 'knitnout' = Ctrl + Shift + K


```

# Úvod

Vážení a milí studující KSS/PV1, 

<br>  

upřímně Vám děkuji za všechna zaslaná data! Níže najdete grafy, které vznikly z dat Vašich nebo Vašich spolužáků. (Možná jste na jejich dotazník odpovídali.) Jsou tu data těch, kteří mi je zvládli poslat do středy 27. 4. 2022 a nezapomněli k nim připojit otázku, nebo vztah, který je především zajímá. K takto specifikovaným vztahům jsem připravil grafy a můžete se na ně všichni podívat a zamyslet se, co nám grafy říkají o vztazích proměnných, které zobrazují. Rád ještě doplním grafy u těch skupin, které mi sice poslaly data, ale žádné pořádné otázky nebo vztahy.  

Ve středu se na semináři nejprve podíváme na grafy z této stránky. Řekneme si, jak by je bylo možné interpretovat, jaké jsou základní principy interpretace dat. Pokud zbyde čas, podíváme se i na data, která jsem dostal bez dobrých otázek/vztahů. Případně se můžeme podívat i na data, která jsem zatím nedostal. Každopádně budeme pracovat tak, že si budeme promítat výsledky a Vy se budete ve skupinkách radit, jak byste je interpretovali a společně budeme Vaše postřehy reflektovat a shrnovat.

<br>  

S úctou,  
František

```{r příprava}
rm(list = ls())
prejmenuj = function(data, pozice, nazvy) {
  names(data)[pozice] = nazvy
  data
}

```




# Grafy 01: Stigmatizace duševně nemocných  

Tým, který pořídil data nám vytipoval tři příčiny a dva následky, celkem tedy 6 vztahů. Zde však najdete jen 3. Proč? Nu, na otázku, zda je stigmatizace duševně nemocných důležitý problém odpověděli jen 3 respondenti, že `Ne`, 149 odpovědělo, že `Ano`, a taková malá diverzita je při analýze nepoužitelná. Věcně je to hezká správa o světě -- lidem to není jedno, uvědomují si, že stigmatizace je důležitý problém. Ale výzkum na tom nepostavíme -- pokud (téměř) všichni odpovídají `Ano`, nedá se určit příčina. Budeme se tedy nakonec zabývat tím, co ovlivňuje názor, že stigmatizace je způsobená neinformovaností.

```{r df2, message=FALSE, warning=FALSE}
## Aktivace packagí
library(readxl)
library(forcats)
library(dplyr)
library(tidyr)


## Načtení a úprava dat do objektu 'df'
df2 = read_xlsx("data2.xlsx") %>%
  select(4, 10, 5:7) %>%
  prejmenuj(1:5, c("Vzdělání", "Informovanost", "Svědek", "Způsobeno\nneinformovaností", "Důležitý problém"))%>%
  mutate(
    Vzdělání =
      recode(
        Vzdělání,
        `Odborné učiliště s výučním listem` = "Vyučen/a", `Střední škola s maturitou` = "SŠ",
        `Vysoká škola (bakalářské studium)` = "VŠ", `Vysoká škola (magisterské studium)` = "VŠ",
        `Vyšší odborné vzdělání` = "SŠ", `Základní škola` = "ZŠ") %>%
      factor(levels = c("ZŠ", "Vyučen/a", "SŠ", "VŠ")),
    Informovanost = factor(Informovanost, levels = c("Ano", "Spíše ano", "Spíše ne", "Ne")),
    `Způsobeno\nneinformovaností` = 
      factor(`Způsobeno\nneinformovaností`, 
             levels = c("Ano", "Spíše ano", "Spíše ne", "Ne")) %>% fct_rev(),
    across(.cols = everything(), ~factor(.x))
    )

```

## Vliv informovanosti  

Nejprve se podíváme na vliv informovanosti. Proměnná je měřená jako subjektivní dojem respondenta, jak je informovaný o problematice duševního onemocnění. 

```{r graf 2.1}
## Aktivace package pro tvorbu grafů (ano, chci, abyste si na to přišli sami...)
library(ggplot2)


## Vykreslení prvního barchartu dle vzoru:
## Vliv 'Informovanosti' na názor, že stigmatizace je 'Způsobena neinformovaností'
df2 %>% 
  ggplot() +
  aes(x = Informovanost, fill = `Způsobeno\nneinformovaností`) +
  geom_bar(position = position_fill()) +
  labs(title = "Vliv 'Informovanosti' na názor, že stigmatizace je 'Způsobena neinformovaností'", y = "Podíl") +
  scale_y_continuous(breaks = seq(0, 1, 0.2), labels = function(x) paste(100 * x, "%")) +
  scale_fill_brewer( palette = "Set2") +
  theme_light()

```

## Vliv vzdělání  

Nyní se podíváme na vliv vzdělání. Proměnná je měřená jako nejvyšší dosažené vzdělání. Aby se výsledky netříštily spoustou kategorií, sloučil jsem různé stupně VŠ vzdělání do kategorie `VŠ` a vyšší odborné a střední s maturitou jsem sloučil do `SŠ`.

```{r graf 2.2}

## Vykreslení druhého barchartu dle vzoru:
## Vliv 'Vzdělání' na názor, že stigmatizace je 'Způsobena neinformovaností'
df2 %>% 
  ggplot() +
  aes(x = Vzdělání, fill = `Způsobeno\nneinformovaností`) +
  geom_bar(position = position_fill()) +
  labs(title = "Vliv 'Vzdělání' na názor, že stigmatizace je 'Způsobena neinformovaností'", y = "Podíl") +
  scale_y_continuous(breaks = seq(0, 1, 0.2), labels = function(x) paste(100 * x, "%")) +
  scale_fill_brewer( palette = "Set2") +
  theme_light() 

```

## Vliv svědectví    

Nakonec se podíváme na vliv skutečnosti, zda byl respondent svědkem stigmatizace lidí s duševním onemocněním. 

```{r graf 2.3}
## Vykreslení třetího barchartu dle vzoru:
## Vliv 'Svědectví' stigmatizace na názor, že stigmatizace je 'Způsobena neinformovaností'
df2 %>% 
  ggplot() +
  aes(x = Svědek, fill = `Způsobeno\nneinformovaností`) +
  geom_bar(position = position_fill()) +
  labs(title = "Vliv 'Svědectví' stigmatizace na názor,\nže stigmatizace je 'Způsobena neinformovaností'", y = "Podíl") +
  scale_y_continuous(breaks = seq(0, 1, 0.2), labels = function(x) paste(100 * x, "%")) +
  scale_fill_brewer( palette = "Set2") +
  theme_light() 

```

## Replikace KSS/KA1

V této části tytéž grafy (resp. první dva), jen je na ně použitá jiná geometrie `geom_count()`.


```{r df2 a dfs2, message=FALSE, warning=FALSE}
## Aktivace packagí
library(readxl)
library(forcats)
library(dplyr)
library(tidyr)


## Načtení a úprava dat do objektu 'df'
df2 = read_xlsx("data2.xlsx") %>%
  
  # Selekce proměnných
  select(4, 10, 5:7) %>%
  prejmenuj(1:5, c("Vzdělání", "Informovanost", "Svědek", "Způsobeno neinformovaností", "Důležitý problém"))%>%
  mutate(
    Vzdělání =
      recode(
        Vzdělání,
        `Odborné učiliště s výučním listem` = "Vyučen/a", `Střední škola s maturitou` = "SŠ",
        `Vysoká škola (bakalářské studium)` = "VŠ", `Vysoká škola (magisterské studium)` = "VŠ",
        `Vyšší odborné vzdělání` = "SŠ", `Základní škola` = "ZŠ") %>%
      factor(levels = c("ZŠ", "Vyučen/a", "SŠ", "VŠ")),
    Informovanost = factor(Informovanost, levels = c("Ano", "Spíše ano", "Spíše ne", "Ne")),
    `Způsobeno neinformovaností` = 
      factor(`Způsobeno neinformovaností`, 
             levels = c("Ano", "Spíše ano", "Spíše ne", "Ne")),
    across(.cols = everything(), ~factor(.x))
    )

dfs24 = df2 %>% group_by(Informovanost, `Způsobeno neinformovaností`) %>%  summarise(n = n())
dfs25 = df2 %>% group_by(Vzdělání, `Způsobeno neinformovaností`) %>%  summarise(n = n())

```


```{r graf 2.4, fig.width=7, fig.height=7}
## Vykreslení prvního barchartu dle vzoru:
## Vliv 'Informovanosti' na názor, že stigmatizace je 'Způsobena neinformovaností'
df2 %>% 
  ggplot() +
  aes(x = Informovanost, y = `Způsobeno neinformovaností`) +
  geom_count(color = "steelblue", alpha = 0.75) +
  geom_text(data = dfs24, aes(label = n), size = 10, color = 'white') +
  labs(title = "Vliv 'Informovanosti' na názor, že stigmatizace je 'Způsobena neinformovaností'", 
       y = "Neinformovanost jako příčina",
       caption = "Pozn.: Velikost kroužků a čísla v nich udávají počty respondentů, kteří zvolili příslušnou kombinaci odpovědí.") +
  scale_size(range = c(15, 60)) +
  guides(size = "none") +
  theme_light()

```



```{r graf 2.5, fig.width=7, fig.height=7}
## Vykreslení prvního barchartu dle vzoru:
## Vliv 'Vzdělání' na názor, že stigmatizace je 'Způsobena neinformovaností'
df2 %>% 
  ggplot() +
  aes(x = Vzdělání, y = `Způsobeno neinformovaností`) +
  geom_count(color = "steelblue", alpha = 0.75) +
  geom_text(data = dfs25, aes(label = n), size = 10, color = 'white') +
  labs(title = "Vliv 'Vzdělání' na názor, že stigmatizace je 'Způsobena neinformovaností'", 
       y = "Neinformovanost jako příčina",
       caption = "Pozn.: Velikost kroužků a čísla v nich udávají počty respondentů, kteří zvolili příslušnou kombinaci odpovědí.") +
  scale_size(range = c(15, 60)) +
  guides(size = "none") +
  theme_light()

```



# Grafy 02: Adopce dětí  

Tým, který pořídil data nám vytipoval jednoduchý vztah: Ovlivňuje věk respondentů ochotu adoptovat si dítě? Věk je kategorizovaný, přičemž kategorie `10-15` a `51 a více` se každá vyskytují jen jednou, proto je připojím k nejbližším kategoriím, aby se výsledky nedrobily. Jako další možné zajímavé faktory jsem narychlo vytipoval pohlaví a fakt, zda má respondent již děti. V datech jsem nechal ještě druhou závisle proměnnou: zda by respondent adoptoval postižené dítě. 

```{r df1}
## data1
df1 = read_xlsx("data1.xlsx") %>%
  select(3, 4, 6, 10, 13) %>%
  prejmenuj(1:5, c("Pohlaví", "Věk", "Děti", "Adopce", "Adopce postiženého")) %>%
  mutate(
    Věk = recode(Věk, `10 - 15` = "16 - 20", `51 a více` = "31 - 50" ),
    across(.cols = everything(), ~factor(.x)),
    Adopce = fct_rev(Adopce),
    `Adopce postiženého` = fct_rev(`Adopce postiženého`))



## data1
df1l = read_xlsx("data1.xlsx") %>%
  select(3, 4, 6, 10, 13) %>%
  prejmenuj(1:5, c("Pohlaví", "Věk", "Děti", "Prostá", "Postiženého")) %>%
  mutate(
    Věk = recode(Věk, `10 - 15` = "16 - 20", `51 a více` = "31 - 50" ),
    across(.cols = everything(), ~factor(.x))) %>% 
  pivot_longer(cols = 4:5, names_to = "Adopce", values_to = "Odpověď") %>% 
  mutate(Odpověď = fct_rev(Odpověď))



```


## Samotná adopce: Věk a pohlaví

Ovlivňuje ochotu k prosté adopci Věk v souhře s pohlavím?

```{r graf 1.1}
df1 %>% 
  ggplot() +
  aes(x = Věk, fill = Adopce) +
  facet_grid(cols = vars(Pohlaví)) +
  geom_bar(position = position_fill()) +
  labs(title = "Vliv 'Věku' a 'Pohlaví' na ochotu k 'Adopci'", y = "Podíl") +
  scale_y_continuous(breaks = seq(0, 1, 0.2), labels = function(x) paste(100 * x, "%")) +
  scale_fill_brewer(palette = "Set2") +
  theme_light() 

```


## Samotná adopce: Věk a rodičovství

Máme jen 40 respondentů, to je určitě málo na to udělat vliv celé trojkombinace věku, pohlaví a rodičovství. Podívejme se tedy zvlášť na vliv kombinace rodičovství a věku. Ovlivňuje ochotu k prosté adopci věk v souhře s rodičovstvím? Pozor! Není to chyba, že některé sloupečky chybí! To znamená, že pro některé kombinace nejsou pozorování... Co jsme se díky této 'náhodě' dozvěděli?

```{r graf 1.2}
df1 %>% 
  ggplot() +
  aes(x = Věk, fill = Adopce) +
  facet_grid(cols = vars(Děti)) +
  geom_bar(position = position_fill()) +
  labs(title = "Vliv 'Věku' a 'Rodičovství' na ochotu k 'Adopci'", y = "Podíl") +
  scale_y_continuous(breaks = seq(0, 1, 0.2), labels = function(x) paste(100 * x, "%")) +
  scale_fill_brewer( palette = "Set2") +
  theme_light() 

```




## Samotná adopce: Rodičovství a pohlaví

Ovlivňuje ochotu k prosté adopci rodičovství v souhře s pohlavím?

```{r graf 1.3}
df1 %>% 
  ggplot() +
  aes(x = Děti, fill = Adopce) +
  facet_grid(cols = vars(Pohlaví)) +
  geom_bar(position = position_fill()) +
  labs(title = "Vliv 'Rodičovství' a 'Pohlaví' na ochotu k 'Adopci'", y = "Podíl") +
  scale_y_continuous(breaks = seq(0, 1, 0.2), labels = function(x) paste(100 * x, "%")) +
  scale_fill_brewer( palette = "Set2") +
  theme_light() 

```


## Adopce postiženého: Věk a pohlaví

Ovlivňuje ochotu k adopci postiženého dítěte věk v souhře s pohlavím?

```{r graf 1.4}
df1 %>% 
  ggplot() +
  aes(x = Věk, fill = `Adopce postiženého`) +
  facet_grid(cols = vars(Pohlaví)) +
  geom_bar(position = position_fill()) +
  labs(title = "Vliv 'Věku' a 'Pohlaví' na ochotu k 'Adopci'", y = "Podíl") +
  scale_y_continuous(breaks = seq(0, 1, 0.2), labels = function(x) paste(100 * x, "%")) +
  scale_fill_brewer("Adopce\npostiženého", palette = "Set2") +
  theme_light() 

```


## Adopce postiženého: Věk a Rodičovství

Ovlivňuje ochotu k adopci postiženého dítěte věk v souhře s rodičovstvím?

```{r graf 1.5}
df1 %>% 
  ggplot() +
  aes(x = Věk, fill = `Adopce postiženého`) +
  facet_grid(cols = vars(Děti)) +
  geom_bar(position = position_fill()) +
  labs(title = "Vliv 'Věku' a 'Pohlaví' na ochotu k 'Adopci'", y = "Podíl") +
  scale_y_continuous(breaks = seq(0, 1, 0.2), labels = function(x) paste(100 * x, "%")) +
  scale_fill_brewer("Adopce\npostiženého", palette = "Set2") +
  theme_light() 

```


## Adopce postiženého: Rodičovství a pohlaví

Ovlivňuje ochotu k adopci postiženého dítěte rodičovství v souhře s pohlavím?

```{r graf 1.6}
df1 %>% 
  ggplot() +
  aes(x = Děti, fill = `Adopce postiženého`) +
  facet_grid(cols = vars(Pohlaví)) +
  geom_bar(position = position_fill()) +
  labs(title = "Vliv 'Věku' a 'Pohlaví' na ochotu k 'Adopci'", y = "Podíl") +
  scale_y_continuous(breaks = seq(0, 1, 0.2), labels = function(x) paste(100 * x, "%")) +
  scale_fill_brewer("Adopce\npostiženého", palette = "Set2") +
  theme_light() 

```


## Rozlišování typu adopce podle věku a pohlaví

```{r graf  1.7}
df1l %>% 
  ggplot() +
  aes(x = Adopce, fill = Odpověď) +
   facet_grid(rows = vars(Pohlaví), cols = vars(Věk)) +
  geom_bar(position = position_fill()) +
  labs(title = "Akceptování podle typu 'Adopce', 'Věku' a 'Pohlaví'", y = "Podíl") +
  scale_y_continuous(breaks = seq(0, 1, 0.2), labels = function(x) paste(100 * x, "%")) +
  scale_fill_brewer(palette = "Set2") +
  theme_light() 

```



## Rozlišování typu adopce podle rodičovství a pohlaví

```{r graf  1.8}
df1l %>% 
  ggplot() +
  aes(x = Děti, fill = Odpověď) +
   facet_grid(rows = vars(Pohlaví), cols = vars(Adopce)) +
  geom_bar(position = position_fill()) +
  labs(title = "Akceptování podle typu 'Adopce', 'Rodičovství' a 'Pohlaví'", y = "Podíl") +
  scale_y_continuous(breaks = seq(0, 1, 0.2), labels = function(x) paste(100 * x, "%")) +
  scale_fill_brewer(palette = "Set2") +
  theme_light() 

```


# Grafy 03: Syndrom vyhoření 

Další projekt se věnoval syndromu vyhoření. Kladl si otázku, jestli respondenti ví, co syndrom vyhoření je, což se ukázalo jako nezajímavá položka, neboť všichni odpověděli správně. Dále si tým klade otázku, zda si respondenti myslí, že stát má preventivní opatření. Tak se k tomu koukneme na graf! Ano, není tam příčina, nevadí, třeba ji najdeme na hodině:


```{r data3, message=FALSE, warning=FALSE}
library(tibble)
library(readr)
library(tidyr)

## data3
df3 = read_csv("data3.csv") %>%
  select(2:6, 8) %>%
  prejmenuj(1:6, c("Věk", "Pohlaví", "Vzdělání", "Ví", "Co", "Prevence")) %>%
  rowid_to_column("ID") %>%
  separate(Co, into = paste0("pol", 1:4), sep = ";") %>%
  pivot_longer(6:9, values_to = "Uvedeno") %>%
  select(-name) %>%
  filter(!is.na(Uvedeno))

```


```{r graf 3.1}
library(stringr)

df3 %>% select(ID, Prevence) %>% unique() %>% 
  mutate(Prevence = str_to_title(Prevence) %>% factor()) %>% 
  ggplot() +
  aes(x = Prevence, fill = Prevence) +
  geom_bar() +
  labs(title = "Má, podle názoru respondenta, stát nástroje na prevenci syndromu vyhoření?", y = "Počet uvedení", x = "") +
  guides(fill = "none") +
  theme_minimal()

```

Z pilnosti jsem vytvořil ještě jeden graf -- jak často respondenti uváděli jednotlivé aspekty syndromu vyhoření:  



```{r graf 3.2}
df3 %>%
  ggplot() +
  aes(x = Uvedeno, fill = Uvedeno) +
  geom_bar() +
  labs(title = "Jak často jednotlivé aspekty syndromu vyhoření respondenti uváděli", y = "Počet uvedení", x = "") +
  guides(fill = "none") +
  theme_minimal()
```

# Grafy 04: Motivace studovat sociální práce   

Další data jsem dostal bez otázek. Upravil jsem je a ukážu Vám tady graf na impulsy studovat sociální práce a graf na zamýšlné cílové skupiny:

```{r data4, warning=FALSE, message=FALSE}

df4 = read_xlsx("Papazianova_Dotazník.xlsx") %>%
  select(2:9) %>%
  prejmenuj(1:8, c("Pohlaví", "Vzdělání", "Zájem", "Zkušenosti", "Vliv pandemie", "Impuls", "Podpora rodiny", "Cílovka")) %>%
  rowid_to_column("ID") %>%
  separate(Impuls, into = paste0("Impuls_", 1:3), sep = ",") %>%
  separate(Cílovka, into = paste0("Cílovka_", 1:5), sep = ",") %>%
  pivot_longer(c(7:9, 11:15), values_to = "Odpověď") %>%
  filter(!is.na(Odpověď)) %>%
  separate(name, into = c("Otázka", "Pořadí")) %>% 
  mutate(Odpověď = str_trim(Odpověď))

```


```{r graf 4.1}
df4 %>% filter(Otázka == "Impuls") %>% 
  ggplot() +
  aes(y = Odpověď, fill = Odpověď) +
  geom_bar() +
  labs(title = "Impulsy studovat sociální práce", x = "Počet uvedení", y = "") +
  guides(fill = "none") +
  theme_minimal()


```

```{r graf 4.2}
df4 %>% filter(Otázka == "Cílovka") %>% 
  ggplot() +
  aes(y = Odpověď, fill = Odpověď) +
  geom_bar() +
  labs(title = "Zamýšlené cílové skupiny", x = "Počet uvedení", y = "") +
  guides(fill = "none") +
  theme_minimal()

```


# Grafy 05: Přístup k postiženým osobám  

Poslední data opět přišla bez otázky. Vyčistil jsem je a zkusil vyrobit nějaký graf -- jaké jsou reakce respondentů na tělesné a mentální postižení:

```{r data5, warning=FALSE, message=FALSE}
df5 = read.csv("Přístup k lidem s postižením .csv", encoding = "UTF-8") %>%
  select(2:9) %>%
  prejmenuj(1:8, c("Pohlaví", "Věk", "Mentální_Zkušenost", "Mentální_Reakce",
                   "Tělesné_Zkušenost", "Tělesné_Reakce", "Praxe", "Postižený kolega")) %>%
  rowid_to_column("ID") %>%
  separate(Praxe, into = paste0("Praxe_", 1:2), sep = ";") %>%
  pivot_longer(cols = 4:7) %>%
  separate(name, into = c("Postižení", "name")) %>%
  pivot_wider(id_cols = 1:7) %>% 
  mutate(Reakce = factor(Reakce) )

```

```{r graf 5.1, warning=FALSE, message=FALSE}
df5 %>% 
  ggplot() +
  aes(x = Postižení, fill = Reakce) +
  geom_bar(position = position_dodge()) +
  labs(title = "Reakce na jednotlivé typy postižení", y = "Počet uvedení", y = "Typy postižení") +
  # guides(fill = "none") +
  theme_minimal()

```




